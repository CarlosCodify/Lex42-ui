<app-header></app-header>

<!-- Hero Section -->
<section class="hero-section">
  <div class="geometric-shapes">
    <div class="triangle triangle-blue triangle-1"></div>
    <div class="triangle triangle-orange triangle-2"></div>
    <div class="triangle triangle-blue-small triangle-3"></div>
    <div class="triangle triangle-orange-small triangle-4"></div>
    <div class="triangle triangle-blue-small triangle-5"></div>
    <div class="triangle triangle-orange triangle-6"></div>
  </div>
  
  <div class="container hero-container">
    <div class="hero-titles-section">
      <h1 class="hero-title">
        Noticias y <span class="text-blue">recursos legales</span> que sí entiendes.
      </h1>
      <p class="hero-description">
        Entérate de lo que está pasando y cómo impacta a tu empresa. Boletines, análisis y consejos legales claros para empresarios como tú.
      </p>
    </div>

    <div class="hero-button-section">
      <a href="mailto:contacto@lex42.co?subject=Solicitud de Consulta" class="btn btn-primary btn-large">
        Agenda una consulta
      </a>
    </div>
  </div>
</section>

<!-- News Content Section -->
@if (!selectedArticle()) {
  <section class="news-section">
    <div class="container">
      <div class="news-header">
        <h2 class="news-title">
          <span class="title-highlight">Recursos legales</span> para tu empresa
        </h2>
        <p class="news-subtitle">
          Accede a boletines, artículos y consejos prácticos creados por nuestros abogados para ayudarte a tomar decisiones informadas y proteger tu negocio.
        </p>
      </div>

      <!-- Search and Filters -->
      <div class="search-filters">
        <div class="search-box">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="search-icon">
            <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M19 19L14.65 14.65" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input 
            type="text" 
            class="search-input" 
            placeholder="Buscar"
            [value]="searchQuery()"
            (input)="onSearchChange($any($event.target).value)"
          >
        </div>

        <div class="filters-container">
          <div class="filter-group" [class.dropdown-open]="isContentTypeDropdownOpen()">
            <div class="custom-dropdown" (click)="toggleContentTypeDropdown()">
              <span class="dropdown-label">Tipo de contenido</span>
              <svg width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg" class="dropdown-arrow">
                <path d="M1 1L6 6L11 1" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            
            @if (isContentTypeDropdownOpen()) {
              <div class="dropdown-menu" (click)="$event.stopPropagation()">
                @for (option of contentTypeOptions; track option.value) {
                  <label class="dropdown-option">
                    <input 
                      type="checkbox" 
                      [checked]="isContentTypeSelected(option.value)"
                      (change)="toggleContentTypeFromString(option.value)"
                    >
                    <span>{{ option.label }}</span>
                  </label>
                }
              </div>
            }
            
            @if (selectedContentTypes().length > 0) {
              <div class="selected-filters">
                @for (type of selectedContentTypes(); track type) {
                  <span class="filter-chip">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="chip-close" (click)="removeContentType(type); $event.stopPropagation()">
                      <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    {{ getContentTypeLabel(type) }}
                  </span>
                }
              </div>
            }
          </div>

          <div class="filter-group" [class.dropdown-open]="isCategoryDropdownOpen()">
            <div class="custom-dropdown" (click)="toggleCategoryDropdown()">
              <span class="dropdown-label">Categoría</span>
              <svg width="12" height="8" viewBox="0 0 12 8" fill="none" xmlns="http://www.w3.org/2000/svg" class="dropdown-arrow">
                <path d="M1 1L6 6L11 1" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            
            @if (isCategoryDropdownOpen()) {
              <div class="dropdown-menu" (click)="$event.stopPropagation()">
                @for (option of categoryOptions; track option.value) {
                  <label class="dropdown-option">
                    <input 
                      type="checkbox" 
                      [checked]="isCategorySelected(option.value)"
                      (change)="toggleCategoryFromString(option.value)"
                    >
                    <span>{{ option.label }}</span>
                  </label>
                }
              </div>
            }
            
            @if (selectedCategories().length > 0) {
              <div class="selected-filters">
                @for (category of selectedCategories(); track category) {
                  <span class="filter-chip">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" class="chip-close" (click)="removeCategory(category); $event.stopPropagation()">
                      <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    {{ getCategoryLabel(category) }}
                  </span>
                }
              </div>
            }
          </div>
        </div>
      </div>

      <!-- Articles Grid -->
      <div class="articles-grid">
        @for (article of filteredArticles(); track article.id) {
          <article class="article-card" (click)="onArticleClick(article.id)">
            <h3 class="article-title">{{ article.title }}</h3>
            
            <div class="article-tags">
              @for (type of article.contentType; track type) {
                <span 
                  class="tag" 
                  [style.background-color]="getTagBackgroundColor(type)"
                  [style.color]="getTagTextColor(type)"
                >
                  {{ getContentTypeLabel(type) }}
                </span>
              }
              @for (category of article.category; track category) {
                <span 
                  class="tag" 
                  [style.background-color]="getTagBackgroundColor(category)"
                  [style.color]="getTagTextColor(category)"
                >
                  {{ getCategoryLabel(category) }}
                </span>
              }
            </div>

            <p class="article-excerpt">{{ article.excerpt }}</p>

            <div class="article-metadata">
              <div class="metadata-row">
                <div class="metadata-item">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12.6667 2.66667H3.33333C2.59695 2.66667 2 3.26362 2 4V13.3333C2 14.0697 2.59695 14.6667 3.33333 14.6667H12.6667C13.403 14.6667 14 14.0697 14 13.3333V4C14 3.26362 13.403 2.66667 12.6667 2.66667Z" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10.6667 1.33333V4" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M5.33333 1.33333V4" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 6.66667H14" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>{{ formatDate(article.publishDate) }}</span>
                </div>
                <div class="metadata-item">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14Z" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 4V8L10.6667 10.6667" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>{{ article.readingTime }} min</span>
                </div>
              </div>
              <div class="metadata-divider"></div>
              <div class="metadata-item">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M13.3333 14C13.3333 12.9391 12.9119 11.9217 12.1618 11.1716C11.4116 10.4214 10.3942 10 9.33333 10H6.66667C5.6058 10 4.58839 10.4214 3.83824 11.1716C3.08809 11.9217 2.66667 12.9391 2.66667 14" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M8 7.33333C9.47276 7.33333 10.6667 6.13943 10.6667 4.66667C10.6667 3.19391 9.47276 2 8 2C6.52724 2 5.33333 3.19391 5.33333 4.66667C5.33333 6.13943 6.52724 7.33333 8 7.33333Z" stroke="#666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>{{ article.author.name }}</span>
              </div>
            </div>

            <button class="btn-ver-mas">Ver más</button>
          </article>
        }
      </div>

      <!-- Pagination -->
      @if (filteredArticles().length > 0) {
        <div class="pagination">
          <div class="pagination-info">
            <select class="pagination-select">
              <option>Resultados {{ filteredArticles().length }}</option>
            </select>
            <span class="pagination-text">1-{{ filteredArticles().length }} of {{ filteredArticles().length }}</span>
          </div>
          <div class="pagination-nav">
            <button class="pagination-btn" disabled>← Anterior</button>
            <button class="pagination-btn active">1</button>
            <button class="pagination-btn" disabled>Siguiente →</button>
          </div>
        </div>
      }
    </div>
  </section>
}

<!-- Article Detail Section -->
@if (selectedArticle()) {
  <section class="article-detail-section">
    <div class="article-detail-container">
      <div class="article-detail-header">
        <button class="back-button" (click)="goBack()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Atrás
        </button>

        <nav class="breadcrumb">
          <a routerLink="/noticias">Noticias</a>
          <span class="breadcrumb-separator">></span>
          <span>{{ selectedArticle()!.title }}</span>
        </nav>
      </div>

      <article class="article-detail">
        <h1 class="article-detail-title">{{ selectedArticle()!.title }}</h1>
        
        <div class="article-divider-full"></div>

        <div class="article-detail-metadata">
          <div class="author-info">
            <div class="author-avatar">
              @if (selectedArticle()!.author.photo) {
                <img [src]="selectedArticle()!.author.photo" [alt]="selectedArticle()!.author.name">
              } @else {
                <div class="avatar-placeholder">{{ selectedArticle()!.author.name.charAt(0) }}</div>
              }
            </div>
            <div class="author-details">
              <span class="metadata-value">{{ selectedArticle()!.author.name }}</span>
              <span class="metadata-label">Nombre</span>
            </div>
          </div>

          <div class="metadata-group">
            <span class="metadata-value">{{ selectedArticle()!.author.specialty }}</span>
            <span class="metadata-label">Especialidad</span>
          </div>

          <div class="metadata-group">
            <span class="metadata-value">{{ formatDate(selectedArticle()!.publishDate) }}</span>
            <span class="metadata-label">Fecha</span>
          </div>

          <div class="metadata-group">
            <span class="metadata-value">{{ getContentTypesLabel(selectedArticle()!.contentType) }}</span>
            <span class="metadata-label">Tipo de Contenido</span>
          </div>

          <div class="metadata-group">
            <span class="metadata-value">{{ getCategoriesLabel(selectedArticle()!.category) }}</span>
            <span class="metadata-label">Categoría</span>
          </div>
        </div>

        <div class="article-divider-partial"></div>

        <div class="article-reading-time-tags">
          <span class="reading-time-text">Tiempo de lectura: {{ selectedArticle()!.readingTime }} min</span>
          <span class="tags-separator">|</span>
          <div class="article-detail-tags">
            @for (tag of selectedArticle()!.tags; track tag) {
              <span class="detail-tag">
                {{ tag }}
              </span>
            }
          </div>
        </div>

        <div class="article-detail-content">
          @for (paragraph of selectedArticle()!.content.split('\n\n'); track $index) {
            <p>{{ paragraph }}</p>
          }
        </div>

        <!-- Related Articles -->
        @if (relatedArticles().length > 0) {
          <div class="related-articles">
            <h3 class="related-title">Artículos relacionados</h3>
            <div class="related-grid">
              @for (related of relatedArticles(); track related.id) {
                <article class="related-card" (click)="onArticleClick(related.id)">
                  <h4 class="related-card-title">{{ related.title }}</h4>
                  <p class="related-card-excerpt">{{ related.excerpt }}</p>
                  <div class="related-card-meta">
                    <span>{{ formatDate(related.publishDate) }}</span>
                    <span>•</span>
                    <span>{{ related.readingTime }} min</span>
                  </div>
                </article>
              }
            </div>
          </div>
        }
      </article>
    </div>
  </section>
}

<app-footer></app-footer>

